{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Dev/Desktop/FullEshop/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Dev/Desktop/FullEshop/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Dev/Desktop/FullEshop/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"C:/Users/Dev/Desktop/FullEshop/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useContext,useReducer}from'react';import{useEffect}from'react';import{Helmet}from'react-helmet-async';import{useNavigate}from'react-router-dom';import LoadingBox from'../components/LoadingBox';import MessageBox from'../components/MessageBox';import{Store}from'../Store';import axios from'axios';import{getError}from'../utils';import{Button}from'react-bootstrap';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var reducer=function reducer(state,action){switch(action.type){case'FETCH_REQUEST':return _objectSpread(_objectSpread({},state),{},{loading:true});case'FETCH_SUCCESS':return _objectSpread(_objectSpread({},state),{},{orders:action.payload,loading:false});case'FETCH_FAIL':return _objectSpread(_objectSpread({},state),{},{loading:false,error:action.payload});default:return state;}};var OrderHistoryPage=function OrderHistoryPage(){var _useContext=useContext(Store),state=_useContext.state;var userInfo=state.userInfo;var navigate=useNavigate();var _useReducer=useReducer(reducer,{loading:true,error:''}),_useReducer2=_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],loading=_useReducer2$.loading,error=_useReducer2$.error,orders=_useReducer2$.orders,dispatch=_useReducer2[1];useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch({type:'FETCH_REQUEST'});_context.prev=1;_context.next=4;return axios.get(\"/api/orders/mine\",{headers:{authorization:\"Bearer \".concat(userInfo.token)}});case 4:_yield$axios$get=_context.sent;data=_yield$axios$get.data;dispatch({type:'FETCH_SUCCESS',payload:data});_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);dispatch({type:'FETCH_ERROR',payload:getError(_context.t0)});case 12:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[userInfo]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsx(\"title\",{children:\"Historique de commandes\"})}),/*#__PURE__*/_jsx(\"h1\",{className:\"my-5\",children:\"Historique de commandes\"}),loading?/*#__PURE__*/_jsx(LoadingBox,{}):error?/*#__PURE__*/_jsx(MessageBox,{}):/*#__PURE__*/_jsxs(\"table\",{className:\"table table-striped\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"to-upper\",children:[/*#__PURE__*/_jsx(\"th\",{children:\"id\"}),/*#__PURE__*/_jsx(\"th\",{children:\"date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"total\"}),/*#__PURE__*/_jsx(\"th\",{children:\"pay\\xE9\"}),/*#__PURE__*/_jsx(\"th\",{children:\"livr\\xE9\"}),/*#__PURE__*/_jsx(\"th\",{children:\"actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:orders.map(function(order){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:order._id}),/*#__PURE__*/_jsx(\"td\",{children:order.createdAt.substring(0,10)}),/*#__PURE__*/_jsxs(\"td\",{children:[order.totalPrice.toFixed(2),\" \\u20AC\"]}),/*#__PURE__*/_jsx(\"td\",{children:order.isPaid?order.paidAt.substring(0,10):'Non'}),/*#__PURE__*/_jsx(\"td\",{children:order.isDelivered?order.deliveredAt.substring(0,10):'Non'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(Button,{type:\"button\",variant:\"light\",onClick:function onClick(){navigate(\"/order/\".concat(order._id));},children:[/*#__PURE__*/_jsx(\"i\",{class:\"fa-solid fa-eye\"}),\" Voir\"]})})]},order._id);})})]})]});};export default OrderHistoryPage;","map":{"version":3,"names":["React","useContext","useReducer","useEffect","Helmet","useNavigate","LoadingBox","MessageBox","Store","axios","getError","Button","reducer","state","action","type","loading","orders","payload","error","OrderHistoryPage","userInfo","navigate","dispatch","fetchData","get","headers","authorization","token","data","map","order","_id","createdAt","substring","totalPrice","toFixed","isPaid","paidAt","isDelivered","deliveredAt"],"sources":["C:/Users/Dev/Desktop/FullEshop/frontend/src/pages/OrderHistoryPage.js"],"sourcesContent":["import React, { useContext, useReducer } from 'react';\r\nimport { useEffect } from 'react';\r\nimport { Helmet } from 'react-helmet-async';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport LoadingBox from '../components/LoadingBox';\r\nimport MessageBox from '../components/MessageBox';\r\nimport { Store } from '../Store';\r\nimport axios from 'axios';\r\nimport { getError } from '../utils';\r\nimport { Button } from 'react-bootstrap';\r\n\r\nconst reducer = (state, action) => {\r\n  switch (action.type) {\r\n    case 'FETCH_REQUEST':\r\n      return { ...state, loading: true };\r\n    case 'FETCH_SUCCESS':\r\n      return { ...state, orders: action.payload, loading: false };\r\n    case 'FETCH_FAIL':\r\n      return { ...state, loading: false, error: action.payload };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nconst OrderHistoryPage = () => {\r\n  const { state } = useContext(Store);\r\n  const { userInfo } = state;\r\n  const navigate = useNavigate();\r\n  const [{ loading, error, orders }, dispatch] = useReducer(reducer, {\r\n    loading: true,\r\n    error: '',\r\n  });\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      dispatch({ type: 'FETCH_REQUEST' });\r\n      try {\r\n        const { data } = await axios.get(`/api/orders/mine`, {\r\n          headers: { authorization: `Bearer ${userInfo.token}` },\r\n        });\r\n        dispatch({ type: 'FETCH_SUCCESS', payload: data });\r\n      } catch (err) {\r\n        dispatch({ type: 'FETCH_ERROR', payload: getError(err) });\r\n      }\r\n    };\r\n    fetchData();\r\n  }, [userInfo]);\r\n\r\n  return (\r\n    <div>\r\n      <Helmet>\r\n        <title>Historique de commandes</title>\r\n      </Helmet>\r\n      <h1 className=\"my-5\">Historique de commandes</h1>\r\n      {loading ? (\r\n        <LoadingBox></LoadingBox>\r\n      ) : error ? (\r\n        <MessageBox></MessageBox>\r\n      ) : (\r\n        <table className=\"table table-striped\">\r\n          <thead>\r\n            <tr className=\"to-upper\">\r\n              <th>id</th>\r\n              <th>date</th>\r\n              <th>total</th>\r\n              <th>payé</th>\r\n              <th>livré</th>\r\n              <th>actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {orders.map((order) => (\r\n              <tr key={order._id}>\r\n                <td>{order._id}</td>\r\n                <td>{order.createdAt.substring(0, 10)}</td>\r\n                <td>{order.totalPrice.toFixed(2)} &euro;</td>\r\n                <td>{order.isPaid ? order.paidAt.substring(0, 10) : 'Non'}</td>\r\n                <td>\r\n                  {order.isDelivered\r\n                    ? order.deliveredAt.substring(0, 10)\r\n                    : 'Non'}\r\n                </td>\r\n                <td>\r\n                  <Button\r\n                    type=\"button\"\r\n                    variant=\"light\"\r\n                    onClick={() => {\r\n                      navigate(`/order/${order._id}`);\r\n                    }}\r\n                  >\r\n                    <i class=\"fa-solid fa-eye\"></i> Voir\r\n                  </Button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrderHistoryPage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}